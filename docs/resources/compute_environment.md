---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "nftower_compute_environment Resource - terraform-provider-nftower"
subcategory: ""
description: |-
  A workspace inside a tower organization.
---

# nftower_compute_environment (Resource)

A workspace inside a tower organization.

## Example Usage

```terraform
resource "nftower_workspace" "example" {
  name      = "foo"
  full_name = "foo bar baz"
}

resource "nftower_credentials" "aws" {
  name         = "aws-creds"
  workspace_id = nftower_workspace.example.id

  aws {
    access_key = "ABDFRGTEDRFS"
    secret_key = "sdkjdlgkdjflgkdglkdnflsrkgdlvkslgkdn"
  }
}


resource "nftower_compute_environment" "example-awsbatch" {
  name           = "example-awsbatch"
  workspace_id   = nftower_workspace.example.id
  credentials_id = nftower_workspace.aws.id

  aws_batch {
    region        = "eu-west-1"
    compute_queue = "compute"
    head_queue    = "head"
    work_dir      = "s3://my-nf-workdir"
  }
}

resource "nftower_compute_environment" "example-lsfplatform" {
  name           = "example-lsfplatform"
  workspace_id   = nftower_workspace.example.id
  credentials_id = nftower_workspace.aws.id

  lsf_platform {
    work_dir      = "s3://my-nf-workdir"
    compute_queue = "compute"
    head_queue    = "head"
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `credentials_id` (String) The id of the credentials to use for the environment.
- `name` (String) The name of the environment. Only alphanumeric characters and dashes are allowed.
- `workspace_id` (String) The id of the workspace in which to create the environment.

### Optional

- `aws_batch` (Block List, Max: 1) Configures an AWS Batch compute environment (manual only). (see [below for nested schema](#nestedblock--aws_batch))
- `description` (String) The description of the environment.
- `environment_variable` (Block List) A List of environment variables that can be included for head or compute jobs. (see [below for nested schema](#nestedblock--environment_variable))

### Read-Only

- `date_created` (String) The datetime the workspace was created.
- `id` (String) The ID of this resource.
- `last_updated` (String) The last updated datetime of the workspace.
- `status` (String) The status of the workspace. Can be CREATING, AVAILABLE, ERRORED or INVALID.

<a id="nestedblock--aws_batch"></a>
### Nested Schema for `aws_batch`

Required:

- `compute_queue` (String) The default Batch queue to which Nextflow will submit job executions. This can be overwritten via the usual Nextflow config.
- `head_queue` (String) The Batch queue that will run the Nextflow application. A queue that does not use spot instances is expected.
- `region` (String) The AWS region name where the environment lives.
- `work_dir` (String) Either an S3 bucket path, a FSx directory path or a EFS directory path. The S3 bucket should be located in the same region as the one chosen previously.

Optional:

- `cli_path` (String) Nextflow requires the AWS CLI tool to be installed in the Ec2 instances launched by Batch. Use this field to specify the path where the tool is located. It must start with a '/' and terminate with the '/bin/aws' suffix.
- `compute_job_role` (String) IAM role to fine-grained control permissions for jobs submitted by Nextflow.
- `execution_role` (String) The execution role grants the Amazon ECS container used by Batch the permission to make API calls on your behalf. This field is only required if the pipeline launched with this compute environment needs to access secrets stored in this workspace. If you are not using secrets you can ignore this field. See "Required IAM permissions for AWS Batch secrets" documentation for more details.
- `head_job_cpus` (Number) The number of CPUs to be allocated for the Nextflow runner job.
- `head_job_memory_mb` (Number) The number of MiB of memory reserved for the Nextflow runner job.
- `head_job_role` (String) IAM role to fine-grained control permissions for the Nextflow runner job.
- `post_run_script` (String) This is an optional Bash script that's executed in the same environment where Nextflow runs immediately after the pipeline completion. The script is executed either the pipeline completes successfully or with an error condition. The error condition can be verified using the environment variable NXF_EXIT_STATUS. It can useful to copy result data or similar tasks.
- `pre_run_script` (String) This is an optional Bash script that's executed in the same environment where Nextflow runs just before the pipeline is launched. It can useful to stage input data or similar tasks.


<a id="nestedblock--environment_variable"></a>
### Nested Schema for `environment_variable`

Required:

- `name` (String) The name of the environment variable must contain only alphanumeric, dash and underscore characters, and cannot begin with a number.
- `value` (String) The value of the environment variable.
- `visibility` (String) Which jobs this environment variable should be available to, can be HEAD, COMPUTE or BOTH.
